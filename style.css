@import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@400;500;600&family=Roboto+Mono&display=swap");

:root {
  /* Color Palette */
  --bg-dark: #0f172a;
  --bg-card: rgba(30, 41, 59, 0.7);
  --text-primary: #f8fafc;
  --text-secondary: #94a3b8;
  --accent-primary: #3b82f6;
  --accent-secondary: #8b5cf6;
  --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
  --correct-color: #10b981;
  --incorrect-color: #ef4444;
  --border-color: rgba(255, 255, 255, 0.1);

  /* Effects */
  --card-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3),
    0 10px 10px -5px rgba(0, 0, 0, 0.2);
  --neon-glow: 0 0 20px rgba(59, 130, 246, 0.3);
  --glass-blur: blur(12px);
  --border-radius: 24px;
  --transition-speed: 0.3s;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: "Inter", sans-serif;
  background-color: var(--bg-dark);
  color: var(--text-primary);
  display: flex;
  justify-content: center;
  align-items: flex-start; /* Safer for scrolling on small screens */
  min-height: 100vh;
  overflow-x: hidden;
  padding: 40px 20px; /* Increased top/bottom padding for breathing room with flex-start */
}

/* Ambient Background */
body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
  background: radial-gradient(
      circle at 15% 50%,
      rgba(59, 130, 246, 0.15),
      transparent 30%
    ),
    radial-gradient(
      circle at 85% 30%,
      rgba(139, 92, 246, 0.15),
      transparent 30%
    );
}

#quiz-container {
  width: 100%;
  max-width: 700px;
  background: var(--bg-card);
  backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--card-shadow);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  margin: auto; /* Centers vertically if there's space */
}

/* Progress Bar */
#progress-bar-container {
  width: 100%;
  height: 6px;
  background-color: rgba(255, 255, 255, 0.1);
}

#progress-bar {
  width: 0%;
  height: 100%;
  background: var(--accent-gradient);
  box-shadow: var(--neon-glow);
  transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Header */
.quiz-header {
  padding: 1.25rem 1.5rem 0.75rem; /* Reduced padding */
  border-bottom: 1px solid var(--border-color);
  text-align: center;
}

h1 {
  font-family: "Space Grotesk", sans-serif;
  font-size: 1.5rem; /* Reduced font size */
  font-weight: 700;
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  letter-spacing: -0.02em;
}

/* Card Container */
#card-container {
  position: relative;
  width: 100%;
  flex-grow: 1;
  /* Min-height provided by content, adjusted by JS */
  min-height: 200px;
}

.card {
  padding: 1.25rem 1.75rem 1.5rem; /* Reduced padding */
  position: absolute;
  width: 100%;
  top: 0;
  left: 0;
  opacity: 0;
  pointer-events: none;
  transform: translateX(50px) scale(0.95);
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
}

.card.active {
  opacity: 1;
  transform: translateX(0) scale(1);
  pointer-events: auto;
  position: relative; /* Make it relative when active so it takes up space? No, absolute is better for transitions, we resize container */
  position: absolute;
}

/* We need a specific rule for the JS height calculation to work smoothly with absolute positioning. 
   Actually, the previous fix used absolute positioning and JS adjusted the container height. 
   We will keep that. The active card is absolute, but has opacity 1. */

.card.exit-next {
  transform: translateX(-50px) scale(0.95);
  opacity: 0;
}

.card.exit-prev {
  transform: translateX(50px) scale(0.95);
  opacity: 0;
}

/* Question Text */
.question-text {
  font-size: 1.15rem; /* Slightly smaller */
  font-weight: 500;
  margin-bottom: 1rem; /* Reduced margin */
  line-height: 1.45;
  color: var(--text-primary);
}

.question-text pre {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 0.75rem; /* Reduced padding */
  margin-top: 0.75rem; /* Reduced margin */
  font-family: "Roboto Mono", monospace;
  font-size: 0.85rem;
  overflow-x: auto;
  color: #e2e8f0;
  max-height: 140px; /* Reduced max-height */
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--text-secondary) rgba(0, 0, 0, 0.1);
}

/* Options */
.options-container {
  display: flex;
  flex-direction: column;
  gap: 0.6rem; /* Reduced gap */
}

.option {
  display: block;
  width: 100%;
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 0.8rem 1rem; /* Reduced padding */
  text-align: left;
  color: var(--text-secondary);
  font-size: 0.95rem; /* Slightly smaller */
  font-family: "Inter", sans-serif;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.option:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(139, 92, 246, 0.5);
  color: var(--text-primary);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.option code {
  font-family: "Roboto Mono", monospace;
  background: rgba(0, 0, 0, 0.3);
  padding: 0.2em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  color: #cbd5e1;
}

/* Answer States */
.options-container.answered .option {
  cursor: default;
  opacity: 0.7;
}

.options-container.answered .option.correct {
  background: rgba(16, 185, 129, 0.2);
  border-color: var(--correct-color);
  color: #d1fae5;
  opacity: 1;
  font-weight: 600;
}

.options-container.answered .option.incorrect {
  background: rgba(239, 68, 68, 0.2);
  border-color: var(--incorrect-color);
  color: #fee2e2;
  opacity: 1;
}

/* Navigation */
#navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.75rem 1.25rem; /* Reduced padding */
  border-top: 1px solid var(--border-color);
  margin-top: auto;
  gap: 1rem;
}

.nav-btn {
  padding: 0.7rem 1.5rem;
  font-family: "Space Grotesk", sans-serif;
  font-size: 1rem;
  font-weight: 600;
  color: white;
  background: var(--accent-gradient);
  border: none;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
    0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.nav-btn:hover:not(:disabled) {
  box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.4),
    0 4px 6px -2px rgba(59, 130, 246, 0.2);
  transform: translateY(-2px);
}

.nav-btn:disabled {
  background: #334155;
  color: #64748b;
  cursor: not-allowed;
  box-shadow: none;
  transform: none;
}

.nav-btn.secondary {
  background: transparent;
  border: 1px solid var(--border-color);
  color: var(--text-secondary);
}

.nav-btn.secondary:hover {
  border-color: var(--text-primary);
  color: var(--text-primary);
  background: rgba(255, 255, 255, 0.05);
}

.nav-btn.hidden {
  visibility: hidden;
}

/* Results */
#results-container {
  padding: 4rem 2rem;
  text-align: center;
  color: var(--text-primary);
}

#results-container h2 {
  font-family: "Space Grotesk", sans-serif;
  font-size: 2.5rem;
  margin-bottom: 2rem;
}

.score-circle {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  background: radial-gradient(
    circle at center,
    rgba(59, 130, 246, 0.2),
    transparent 70%
  );
  border: 4px solid var(--accent-primary);
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0 auto 2rem;
  font-family: "Space Grotesk", sans-serif;
  font-size: 3rem;
  font-weight: 700;
  color: var(--accent-primary);
  box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
}

.results-actions {
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  margin-top: 3rem;
}

/* Mobile */
/* Tablet Layout */
@media (max-width: 900px) and (min-width: 651px) {
  body {
    padding: 2rem 1rem;
    align-items: center;
  }
  
  #quiz-container {
    max-width: 90%;
    /* Let height adapt naturally on tablet, but ensure it doesn't exceed viewport too wildly */
    max-height: 90vh;
    overflow-y: auto;
  }

  h1 { font-size: 1.4rem; }
  .question-text { font-size: 1.1rem; }
}

/* Mobile App Shell Layout */
@media (max-width: 650px) {
  body {
    padding: 0;
    overflow: hidden; /* Prevent body scroll, handle inside container */
    align-items: stretch; /* Stretch container to fill height */
  }

  #quiz-container {
    width: 100%;
    max-width: 100%;
    height: 100dvh; /* Fixed full viewport height */
    min-height: 0; /* Override any min-height */
    border-radius: 0;
    border: none;
    margin: 0;
    display: flex;
    flex-direction: column;
  }

  .quiz-header {
    flex: 0 0 auto; /* Fixed header */
    padding: 0.75rem 1rem 0.5rem; /* Smooshed header */
    background: var(--bg-dark); 
    z-index: 10;
    border-bottom: 1px solid var(--border-color);
  }

  h1 { font-size: 1.2rem; margin-bottom: 0; } /* Smaller title */

  #card-container {
    flex: 1 1 auto; /* Grow to fill space */
    position: relative;
    overflow-y: auto; /* Internal scroll */
    overflow-x: hidden;
    height: auto !important; 
    padding: 0;
    /* Scrollbar styling for mobile */
    scrollbar-width: thin;
  }

  /* Force active card to flow in the scroll container */
  .card.active {
    position: relative;
    opacity: 1;
    transform: translateX(0) scale(1);
    pointer-events: auto;
    padding: 1rem; /* Reduced padding from 1.5rem */
    padding-bottom: 1.5rem;
  }
  
  .card:not(.active) {
      display: none; /* Hide inactive cards so they don't affect scroll height */
  }

  .question-text { 
    font-size: 1rem; 
    margin-bottom: 0.5rem; 
    line-height: 1.3;
  }
  
  .question-text pre {
      margin-top: 0.5rem;
      padding: 0.5rem;
      max-height: 110px; /* Force code blocks to be shorter to show more options */
      font-size: 0.8rem;
  }

  .options-container {
      gap: 0.5rem;
  }

  .option { 
    padding: 0.6rem 0.8rem; 
    font-size: 0.9rem;
    border-radius: 8px; /* Slightly smaller radius */
  }

  #navigation {
    flex: 0 0 auto; /* Fixed footer */
    padding: 0.75rem 1rem; /* Compact footer */
    margin-top: 0;
    background: var(--bg-dark); 
    border-top: 1px solid var(--border-color);
    z-index: 10;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
  }
  
  .nav-btn {
      padding: 0.6rem 1.2rem;
      font-size: 0.95rem;
  }
}

